(function(a,b,c){"use strict";var d={html:'<!DOCTYPE html><html><head><style>.ie * {min-height: auto !important}</style><meta http-equiv="Content-Type" content="text/html;charset={charset}" /><link rel="stylesheet" type="text/css" href="{style}" /></head><body contenteditable="true"></body></html>',toolbarButton:'<a class="sceditor-button sceditor-button-{name}" data-sceditor-command="{name}" unselectable="on"><div unselectable="on">{dispName}</div></a>',emoticon:'<img src="{url}" data-sceditor-emoticon="{key}" alt="{key}" title="{tooltip}" />',fontOpt:'<a class="sceditor-font-option" href="#" data-font="{font}"><font face="{font}">{font}</font></a>',sizeOpt:'<a class="sceditor-fontsize-option" data-size="{size}" href="#"><font size="{size}">{size}</font></a>',pastetext:'<div><label for="txt">{label}</label> <textarea cols="20" rows="7" id="txt"></textarea></div><div><input type="button" class="button" value="{insert}" /></div>',table:'<div><label for="rows">{rows}</label><input type="text" id="rows" value="2" /></div><div><label for="cols">{cols}</label><input type="text" id="cols" value="2" /></div><div><input type="button" class="button" value="{insert}" /></div>',image:'<div><label for="link">{url}</label> <input type="text" id="image" value="http://" /></div><div><label for="width">{width}</label> <input type="text" id="width" size="2" /></div><div><label for="height">{height}</label> <input type="text" id="height" size="2" /></div><div><input type="button" class="button" value="{insert}" /></div>',email:'<div><label for="email">{label}</label> <input type="text" id="email" /></div><div><input type="button" class="button" value="{insert}" /></div>',link:'<div><label for="link">{url}</label> <input type="text" id="link" value="http://" /></div><div><label for="des">{desc}</label> <input type="text" id="des" /></div><div><input type="button" class="button" value="{ins}" /></div>',youtubeMenu:'<div><label for="link">{label}</label> <input type="text" id="link" value="http://" /></div><div><input type="button" class="button" value="{insert}" /></div>',youtube:'<iframe width="560" height="315" src="http://www.youtube.com/embed/{id}?wmode=opaque" data-youtube-id="{id}" frameborder="0" allowfullscreen></iframe>'},e=function(b,c,e){var f=d[b];return a.each(c,function(a,b){f=f.replace(new RegExp("\\{"+a+"\\}","g"),b)}),e&&(f=a(f)),f};a.sceditor=function(d,f){var g=this,h=d.get?d.get(0):d,i=a(h),j,k,l,m,n,o,p,q=[],r,s,t=[],u,v=[],w=[],x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_,ab,bb,cb,db,eb,fb;g.commands=a.extend(!0,{},f.commands||a.sceditor.commands),D=function(){i.data("sceditor",g),g.opts=a.extend({},a.sceditor.defaultOptions,f),g.opts.locale&&g.opts.locale!=="en"&&J(),j=a('<div class="sceditor-container" />').insertAfter(i),g.opts.zIndex!==null&&j.css("z-index",g.opts.zIndex),a.sceditor.ie&&j.addClass("ie").addClass("ie"+a.sceditor.ie),C=!!i.attr("required"),i.removeAttr("required"),I(),K(),H(),N(),L(),M(),a.sceditor.isWysiwygSupported||g.toggleSourceMode(),P();if(g.opts.autoExpand||g.opts.autofocus)var b=setInterval(function(){if(!c.readyState||c.readyState==="complete")clearInterval(b),g.opts.autofocus&&eb(),g.opts.autoExpand&&g.expandToContent()},10);_(),y.call("ready")},I=function(){var b=g.opts.plugins;b=b?b.toString().split(","):[],y=new a.sceditor.PluginManager(g),a.each(b,function(b,c){y.register(a.trim(c))})},J=function(){var b;a.sceditor.locale[g.opts.locale]?s=a.sceditor.locale[g.opts.locale]:(b=g.opts.locale.split("-"),a.sceditor.locale[b[0]]&&(s=a.sceditor.locale[b[0]])),s&&s.dateFormat&&(g.opts.dateFormat=s.dateFormat)},H=function(){var c,d,f,h;n=a("<textarea></textarea>").hide(),l=a('<iframe frameborder="0"></iframe>'),b.location.protocol==="https:"&&l.attr("src","javascript:false"),j.append(l).append(n),m=l[0],o=n[0],g.width(g.opts.width||i.width()),g.height(g.opts.height||i.height()),d=Q(),f=a(d),d.open(),d.write(e("html",{charset:g.opts.charset,style:g.opts.style})),d.close(),g.readOnly(!!g.opts.readOnly),c=f.find("body"),a.sceditor.ie&&f.find("html").addClass("ie").addClass("ie"+a.sceditor.ie),(/iPhone|iPod|iPad| wosbrowser\//i.test(navigator.userAgent)||a.sceditor.ie)&&c.height("100%"),u=new a.sceditor.rangeHelper(m.contentWindow),g.val(i.hide().val()),typeof (h=i.attr("tabindex"))!="undefined"&&(n.attr("tabindex",h),l.attr("tabindex",h))},L=function(){var b=a(Q()),c=b.find("body");g.opts.autoUpdate&&(c.bind("blur",g.updateOriginal),n.bind("blur",g.updateOriginal)),g.opts.rtl===null&&(g.opts.rtl=n.css("direction")==="rtl"),g.opts.rtl&&g.rtl(!0),g.opts.autoExpand&&b.bind("keyup",g.expandToContent),g.opts.resizeEnabled&&O(),g.opts.id&&j.attr("id",g.opts.id)},M=function(){var d=a(Q());a(c).click(X),a(h.form).bind("reset",U).submit(g.updateOriginal),a(b).bind("resize orientationChanged",Y),d.find("body").keypress(T).keyup(bb).bind("paste",R).bind(a.sceditor.ie?"selectionchange":"keyup focus blur contextmenu mouseup touchend click",cb).bind("keydown keyup keypress focus blur contextmenu",W),n.bind("keydown keyup keypress focus blur contextmenu",W),d.keypress(T).mousedown(V).bind(a.sceditor.ie?"selectionchange":"focus blur contextmenu mouseup click",cb).bind("beforedeactivate keyup",G).keyup(bb).focus(function(){r=null}),j.bind("selectionchanged",_).bind("selectionchanged",db).bind("selectionchanged",W).bind("nodechanged",W)},K=function(){var b,c,d,f,h,i,l=g.opts.toolbar.split("|");i=function(){var b=a(this);return b.hasClass("disabled")||F(b,g.commands[b.data("sceditor-command")]),_(),!1},k=a('<div class="sceditor-toolbar" unselectable="on" />');for(f=0;f<l.length;f++){b=a('<div class="sceditor-group" />'),d=l[f].split(",");for(h=0;h<d.length;h++){if(!g.commands[d[h]])continue;c=e("toolbarButton",{name:d[h],dispName:g.commands[d[h]].tooltip||d[h]},!0).click(i).data("sceditor-txtmode",!!g.commands[d[h]].txtExec).data("sceditor-wysiwygmode",!!g.commands[d[h]].exec),g.commands[d[h]].tooltip&&c.attr("title",g._(g.commands[d[h]].tooltip)),g.commands[d[h]].exec||c.addClass("disabled"),b.append(c)}k.append(b)}g.opts.toolbarContainer?a(g.opts.toolbarContainer).append(k):j.append(k)},N=function(){a.each(g.commands,function(b,c){c.keyPress&&q.push(c.keyPress),c.forceNewLineAfter&&a.isArray(c.forceNewLineAfter)&&(v=a.merge(v,c.forceNewLineAfter)),c.state?w.push({name:b,state:c.state}):typeof c.exec=="string"&&w.push({name:b,state:c.exec})})},O=function(){var d,e,f,h,i,k,l=a('<div class="sceditor-grip" />'),m=a('<div class="sceditor-resize-cover" />'),n=0,o=0,p=0,q=0,r=j.width(),s=j.height(),t=!1,u=g.rtl();d=g.opts.resizeMinHeight||s/1.5,e=g.opts.resizeMaxHeight||s*2.5,f=g.opts.resizeMinWidth||r/1.25,h=g.opts.resizeMaxWidth||r*1.25,i=function(a){a.type==="touchmove"&&(a=b.event);var c=q+(a.pageY-o),i=u?p-(a.pageX-n):p+(a.pageX-n);h>0&&i>h&&(i=h),e>0&&c>e&&(c=e),g.opts.resizeWidth&&i>=f&&(h<0||i<=h)&&g.width(i),g.opts.resizeHeight&&c>=d&&(e<0||c<=e)&&g.height(c),a.preventDefault()},k=function(b){if(!t)return;t=!1,m.hide(),j.removeClass("resizing"),a(c).unbind("touchmove mousemove",i),a(c).unbind("touchend mouseup",k),b.preventDefault()},j.append(l),j.append(m.hide()),l.bind("touchstart mousedown",function(d){d.type==="touchstart"&&(d=b.event),n=d.pageX,o=d.pageY,p=j.width(),q=j.height(),t=!0,j.addClass("resizing"),m.show(),a(c).bind("touchmove mousemove",i),a(c).bind("touchend mouseup",k),d.preventDefault()})},P=function(){g.opts.emoticonsRoot&&g.opts.emoticons&&a.each(g.opts.emoticons,function(b,c){a.each(c,function(a,c){g.opts.emoticons[b][a]=g.opts.emoticonsRoot+(c.url||c)})});var b=a.extend({},g.opts.emoticons.more,g.opts.emoticons.dropdown,g.opts.emoticons.hidden),d;a.each(b,function(a,b){d=c.createElement("img"),d.src=b.url||b,t.push(d)}),g.emoticons(g.opts.emoticonsEnabled)},eb=function(){var b,c,d,e,f=Q(),h=f.body,i=!!g.opts.autofocusEnd;g.sourceMode()?(e=o.value.length,o.setSelectionRange?o.setSelectionRange(e,e):o.createTextRange&&(b=o.createTextRange(),b.moveEnd("character",e),b.moveStart("character",e),u.selectRange(b))):(i?a(h).append(d=f.createElement("div")):d=h.firstChild,f.createRange?(b=f.createRange(),b.setStart(d,0),b.setEnd(d,0)):(b=h.createTextRange(),b.moveToElementText(d),b.collapse(!1)),u.selectRange(b),i&&(a(f).scrollTop(h.scrollHeight),a(h).scrollTop(h.scrollHeight))),g.focus()},g.readOnly=function(a){return typeof a!="boolean"?n.attr("readonly")==="readonly":(Q().body.contentEditable=!a,a?n.attr("readonly","readonly"):n.removeAttr("readonly"),Z(a),this)},g.rtl=function(b){var c=b?"rtl":"ltr";return typeof b!="boolean"?n.attr("dir")==="rtl":(a(Q().body).attr("dir",c),n.attr("dir",c),j.removeClass("rtl").removeClass("ltr").addClass(c),this)},Z=function(b){var c=g.inSourceMode();k.find(".sceditor-button").removeClass("disabled").each(function(){var d=a(this);b===!0||c&&!d.data("sceditor-txtmode")?d.addClass("disabled"):!c&&!d.data("sceditor-wysiwygmode")&&d.addClass("disabled")})},g.width=function(a,b){return!a&&a!==0?j.width():(g.dimensions(a,null,b),this)},g.dimensions=function(a,b,c){var d,e=!1;return a=!a&&a!==0?!1:a,b=!b&&b!==0?!1:b,a===!1&&b===!1?{width:g.width(),height:g.height()}:(typeof l.data("outerWidthOffset")=="undefined"&&g.updateStyleCache(),a!==!1&&a!==g.width()&&(c!==!1&&(g.opts.width=a),a=j.width(a).width(),m.style.width=a-l.data("outerWidthOffset")+"px",o.style.width=a-n.data("outerWidthOffset")+"px",d=g.opts.toolbarContainer?0:k.outerHeight(!0),e=d!==(g.opts.toolbarContainer?0:k.outerHeight(!0)),b=b!==!1?b:g.height()),b!==!1&&b!==g.height()&&(c!==!1&&(g.opts.height=b),b=j.height(b).height(),b-=g.opts.toolbarContainer?0:k.outerHeight(!0),e=!0),e&&(m.style.height=b-l.data("outerHeightOffset")+"px",o.style.height=b-n.data("outerHeightOffset")+"px"),this)},g.updateStyleCache=function(){l.data("outerWidthOffset",l.outerWidth(!0)-l.width()),n.data("outerWidthOffset",n.outerWidth(!0)-n.width()),l.data("outerHeightOffset",l.outerHeight(!0)-l.height()),n.data("outerHeightOffset",n.outerHeight(!0)-n.height())},g.height=function(a,b){return!a&&a!==0?j.height():(g.dimensions(null,a,b),this)},g.maximize=function(b){return typeof b=="undefined"?j.is(".sceditor-maximize"):(b=!!b,a.sceditor.ie<7&&a("html, body").toggleClass("sceditor-maximize",b),j.toggleClass("sceditor-maximize",b),g.width(b?"100%":g.opts.width,!1),g.height(b?"100%":g.opts.height,!1),this)},g.expandToContent=function(a){var b=Q(),c=j.height(),d=b.body.scrollHeight||b.documentElement.scrollHeight,e=c-l.height(),f=g.opts.resizeMaxHeight||(g.opts.height||i.height())*2;d+=e,a!==!0&&d>f&&(d=f),d>c&&g.height(d)},g.destroy=function(){y.destroy(),u=null,r=null,y=null,a(c).unbind("click",X),a(b).unbind("resize",Y),a(h.form).unbind("reset",U).unbind("submit",g.updateOriginal),a(Q().body).unbind(),a(Q()).unbind().find("*").remove(),n.unbind().remove(),j.unbind().find("*").unbind().remove(),j.remove(),i.removeData("sceditor").removeData("sceditorbbcode").show(),C&&i.attr("required","required")},g.createDropDown=function(b,c,d,e){var f=p&&p.is(".sceditor-"+c);g.closeDropDown();if(f)return;e!==!1&&a(d).find(":not(input,textarea)").filter(function(){return this.nodeType===1}).attr("unselectable","on");var h={top:b.offset().top,left:b.offset().left,marginTop:b.outerHeight()};a.extend(h,g.opts.dropDownCss),p=a('<div class="sceditor-dropdown sceditor-'+c+'" />').css(h).append(d).appendTo(a("body")).click(function(a){a.stopPropagation()})},X=function(a){a.which!==3&&g.closeDropDown()},R=function(a){function i(a,b){if(a.childNodes.length>0){while(a.firstChild)b.appendChild(a.firstChild);while(h.firstChild)a.appendChild(h.firstChild);S(a,b)}else{if(e>25){while(h.firstChild)a.appendChild(h.firstChild);u.restoreRange();return}++e,setTimeout(function(){i(a,b)},20)}}var b,d=Q().body,e=0,f=d.ownerDocument.createElement("div"),h=d.ownerDocument.createDocumentFragment();if(g.opts.disablePasting)return!1;if(!g.opts.enablePasteFiltering)return;u.saveRange(),c.body.appendChild(f);if(a&&a.clipboardData&&a.clipboardData.getData)if((b=a.clipboardData.getData("text/html"))||(b=a.clipboardData.getData("text/plain")))return f.innerHTML=b,S(d,f),a.stopPropagation(),a.preventDefault(),!1;while(d.firstChild)h.appendChild(d.firstChild);return i(d,f),g.focus(),!0},S=function(b,c){a.sceditor.dom.fixNesting(c);var d=c.innerHTML;y.hasHandler("toSource")&&(d=y.callOnlyFirst("toSource",d,a(c))),c.parentNode.removeChild(c),y.hasHandler("toWysiwyg")&&(d=y.callOnlyFirst("toWysiwyg",d,!0)),u.restoreRange(),u.insertHTML(E(d))},g.closeDropDown=function(a){p&&(p.unbind().remove(),p=null),a===!0&&g.focus()},Q=function(){return m.contentDocument?m.contentDocument:m.contentWindow&&m.contentWindow.document?m.contentWindow.document:m.document?m.document:null},g.wysiwygEditorInsertHtml=function(b,c,d){g.focus();if(!d&&(a(u.parentNode()).is("code")||a(u.parentNode()).parents("code").length!==0))return;u.insertHTML(b,c),bb()},g.wysiwygEditorInsertText=function(b,c){g.wysiwygEditorInsertHtml(a.sceditor.escapeEntities(b),a.sceditor.escapeEntities(c))},g.insertText=function(a,b){return g.inSourceMode()?g.sourceEditorInsertText(a,b):g.wysiwygEditorInsertText(a,b),this},g.sourceEditorInsertText=function(a,b){var d,e,f,g,h;h=o.scrollTop,o.focus(),typeof o.selectionStart!="undefined"?(e=o.selectionStart,f=o.selectionEnd,g=a.length,b&&(a+=o.value.substring(e,f)+b),o.value=o.value.substring(0,e)+a+o.value.substring(f,o.value.length),o.selectionStart=e+a.length-(b?b.length:0),o.selectionEnd=o.selectionStart):typeof c.selection.createRange!="undefined"?(d=c.selection.createRange(),b&&(a+=d.text+b),d.text=a,b&&d.moveEnd("character",0-b.length),d.moveStart("character",d.End-d.Start),d.select()):o.value+=a+b,o.scrollTop=h,o.focus()},g.getRangeHelper=function(){return u},g.val=function(a,b){return typeof a=="string"?(g.inSourceMode()?g.setSourceEditorValue(a):(b!==!1&&y.hasHandler("toWysiwyg")&&(a=y.callOnlyFirst("toWysiwyg",a)),g.setWysiwygEditorValue(a)),this):g.inSourceMode()?g.getSourceEditorValue(!1):g.getWysiwygEditorValue()},g.insert=function(b,c,d,e){if(g.inSourceMode())g.sourceEditorInsertText(b,c);else{if(c){var f=g.getRangeHelper().selectedHtml(),h=a("<div>").appendTo(a("body")).hide().html(f);d!==!1&&(y.hasHandler("toSource")&&(f=y.callOnlyFirst("toSource",f,h)),h.remove()),b+=f+c}y.hasHandler("toWysiwyg")&&(b=y.callOnlyFirst("toWysiwyg",b,!0)),e!==!1&&(b=E(b)),g.wysiwygEditorInsertHtml(b)}return this},g.getWysiwygEditorValue=function(b){var c,d=l.contents().find("body");return a.sceditor.ie&&g.focus(),u.saveRange(),a.sceditor.dom.fixNesting(d.get(0)),c=d.html(),b!==!1&&y.hasHandler("toSource")&&(c=y.callOnlyFirst("toSource",c,d)),u.restoreRange(),r=null,c},g.getSourceEditorValue=function(a){var b=n.val();return a!==!1&&y.hasHandler("toWysiwyg")&&(b=y.callOnlyFirst("toWysiwyg",b)),b},g.setWysiwygEditorValue=function(b){b||(b="<p>"+(a.sceditor.ie?"":"<br />")+"</p>"),Q().body.innerHTML=E(b),bb()},g.setSourceEditorValue=function(a){n.val(a)},g.updateOriginal=function(){i.val(g.val())},E=function(b){if(!g.opts.emoticonsEnabled)return b;var c=a.extend({},g.opts.emoticons.more,g.opts.emoticons.dropdown,g.opts.emoticons.hidden);return a.each(c,function(c,d){var f=a.sceditor.regexEscape(c)+"(?=([^\\<\\>]*?<(?!/code)|[^\\<\\>]*?$))",h="";g.opts.emoticonsCompat&&(f="((>|^|\\s| | | | |&nbsp;))"+f+"(?=(\\s|$|<| | | | |&nbsp;))",h="$1"),b=b.replace(new RegExp(f,"gm"),h+e("emoticon",{key:c,url:d.url||d,tooltip:d.tooltip||c}))}),b},g.inSourceMode=function(){return j.hasClass("sourceMode")},g.sourceMode=function(a){return typeof a!="boolean"?g.inSourceMode():((g.inSourceMode()&&!a||!g.inSourceMode()&&a)&&g.toggleSourceMode(),this)},g.toggleSourceMode=function(){if(!a.sceditor.isWysiwygSupported&&g.inSourceMode())return;g.inSourceMode()?g.setWysiwygEditorValue(g.getSourceEditorValue()):g.setSourceEditorValue(g.getWysiwygEditorValue()),r=null,n.toggle(),l.toggle(),g.inSourceMode()?j.removeClass("sourceMode").addClass("wysiwygMode"):j.removeClass("wysiwygMode").addClass("sourceMode"),Z(),_()},ab=function(){o.focus();if(o.selectionStart!=null)return o.value.substring(o.selectionStart,o.selectionEnd);if(c.selection.createRange)return c.selection.createRange().text},F=function(b,c){if(g.inSourceMode()){c.txtExec&&(a.isArray(c.txtExec)?g.sourceEditorInsertText.apply(g,c.txtExec):c.txtExec.call(g,b,ab()));return}if(!c.exec)return;a.isFunction(c.exec)?c.exec.call(g,b):g.execCommand(c.exec,c.hasOwnProperty("execParam")?c.execParam:null)},G=function(){a.sceditor.ie&&(r=u.selectedRange())},g.execCommand=function(b,c){var d=!1,e=a(u.parentNode());g.focus();if(e.is("code")||e.parents("code").length!==0)return;if(Q())try{d=Q().execCommand(b,!1,c)}catch(f){}!d&&g.commands[b]&&g.commands[b].errorMessage&&alert(g._(g.commands[b].errorMessage))},cb=function(){if(B)return;B=!0,setTimeout(function(){u.compare(A)||(A=u.cloneSelected(),j.trigger(a.Event("selectionchanged"))),B=!1},100)},db=function(){var b=u.parentNode();z!==b&&(j.trigger(a.Event("nodechanged",{oldNode:z,newNode:b})),z=b)},g.currentNode=function(){return z},_=function(a){var b,c,d,e,f,h=Q(),i=w.length,j=g.sourceMode();if(!g.sourceMode()&&!g.readOnly()){f=a?a.newNode:u.parentNode(),d=u.getFirstBlockParent(f);while(i--){b=0,c=w[i],e=k.find(".sceditor-button-"+c.name);if(j&&!e.data("sceditor-txtmode"))e.addClass("disabled");else if(!j&&!e.data("sceditor-wysiwygmode"))e.addClass("disabled");else{if(typeof c.state=="string")try{b=h.queryCommandEnabled(c.state)?0:-1,b>-1&&(b=h.queryCommandState(c.state)?1:0)}catch(a){}else b=c.state.call(g,f,d);b<0?e.addClass("disabled"):e.removeClass("disabled"),b>0?e.addClass("active"):e.removeClass("active")}}}else k.find(".sceditor-button").removeClass("active")},T=function(b){var c,d=q.length;g.closeDropDown(),c=a(u.parentNode());if(b.which===13)if(c.is("code,blockquote,pre")||c.parents("code,blockquote,pre").length!==0)return r=null,g.wysiwygEditorInsertHtml("<br />",null,!0),!1;if(c.is("code")||c.parents("code").length!==0)return;while(d--)q[d].call(g,b,m,n)},bb=function(){var b,c,d=Q();a.sceditor.dom.rTraverse(d.body,function(e){b=e.nodeName.toLowerCase(),a.inArray(b,v)>-1&&(c=!0);if(e.nodeType===3&&!/^\s*$/.test(e.nodeValue)||e.nodeName.toLowerCase()==="br"||a.sceditor.ie&&!e.firstChild&&!a.sceditor.dom.isInline(e,!1))return c&&a(d.body).append(a("<div>"+(a.sceditor.ie?"":"<br />")+"</div>\n")),!1})},U=function(){g.val(i.val())},V=function(){g.closeDropDown(),r=null},Y=function(){if(g.maximize()){g.height("100%",!1).width("100%",!1);return}g.opts.height&&g.opts.height.toString().indexOf("%")>-1&&g.height(j.parent().height()*(parseFloat(g.opts.height)/100)),g.opts.width&&g.opts.width.toString().indexOf("%")>-1&&g.width(j.parent().width()*(parseFloat(g.opts.width)/100))},g._=function(){var a=arguments;return s&&s[a[0]]&&(a[0]=s[a[0]]),a[0].replace(/\{(\d+)\}/g,function(b,c){return typeof a[c-0+1]!="undefined"?a[c-0+1]:"{"+c+"}"})},W=function(b){var c,d=a.extend({},b);y.call(d.type+"Event",b,g),delete d.type,c=a.Event((b.target===o?"scesrc":"scewys")+b.type,d),j.trigger.apply(j,[c,g]),c.isDefaultPrevented()&&b.preventDefault(),c.isImmediatePropagationStopped()&&c.stopImmediatePropagation(),c.isPropagationStopped()&&c.stopPropagation()},g.bind=function(b,c,d,e){var f=b.length;b=b.split(" ");while(f--)a.isFunction(c)&&(d||j.bind("scewys"+b[f],c),e||j.bind("scesrc"+b[f],c));return this},g.unbind=function(b,c,d,e){var f=b.length;b=b.split(" ");while(f--)a.isFunction(c)&&(d||j.unbind("scewys"+b[f],c),e||j.unbind("scesrc"+b[f],c));return this},g.blur=function(b,c,d){return a.isFunction(b)?g.bind("blur",b,c,d):g.sourceMode()?n.blur():(x||(x=a('<input style="width:0;height:0;opacity:0;border:0;padding:0;filter:alpha(opacity=0)" type="text" />').appendTo(j)),x.removeAttr("disabled").show().focus().blur().hide().attr("disabled","disabled")),this},g.focus=function(b,c,d){return a.isFunction(b)?g.bind("focus",b,c,d):g.inSourceMode()?o.focus():(m.contentWindow.focus(),Q().body.focus(),r&&(u.selectRange(r),r=null)),this},g.keyDown=function(a,b,c){return g.bind("keydown",a,b,c)},g.keyPress=function(a,b,c){return g.bind("keypress",a,b,c)},g.keyUp=function(a,b,c){return g.bind("keyup",a,b,c)},g.nodeChanged=function(a){return g.bind("nodechanged",a,!1,!0)},g.selectionChanged=function(a){return g.bind("selectionchanged",a,!1,!0)},fb=function(b){var c=0,d=String.fromCharCode(b.which);g.emoticonsCache||(g.emoticonsCache=[],a.each(a.extend({},g.opts.emoticons.more,g.opts.emoticons.dropdown,g.opts.emoticons.hidden),function(a,b){g.emoticonsCache[c++]=[a,e("emoticon",{key:a,url:b.url||b,tooltip:b.tooltip||a})]}),g.emoticonsCache.sort(function(a,b){return a[0].length-b[0].length})),g.longestEmoticonCode||(g.longestEmoticonCode=g.emoticonsCache[g.emoticonsCache.length-1][0].length);if(g.getRangeHelper().raplaceKeyword(g.emoticonsCache,!0,!0,g.longestEmoticonCode,g.opts.emoticonsCompat,d))return/^\s$/.test(d)&&g.opts.emoticonsCompat?!0:(b.preventDefault(),b.stopPropagation(),!1)},g.emoticons=function(b){if(!b&&b!==!1)return g.opts.emoticonsEnabled;var c=a(Q().body);return g.opts.emoticonsEnabled=b,b?(c.keypress(fb),g.sourceMode()||(u.saveRange(),c.html(E(c.html())),u.restoreRange())):(c.find("img[data-sceditor-emoticon]").replaceWith(function(){return a(this).data("sceditor-emoticon")}),c.unbind("keypress",fb)),this},D()},a.sceditor.ie=function(){var a,d=3,e=c.createElement("div"),f=e.getElementsByTagName("i");do e.innerHTML="<!--[if gt IE "+ ++d+"]><i></i><![endif]-->";while(f[0]);return c.all&&b.atob&&(d=10),d>4?d:a}(),a.sceditor.isWysiwygSupported=function(){var b,c=a('<div contenteditable="true">')[0].contentEditable,d=typeof c!="undefined"&&c!=="inherit",e=navigator.userAgent;if(!d)return!1;var f=/Opera Mobi|Opera Mini/i.test(e);return/Android/i.test(e)&&(f=!0,/Safari/.test(e)&&(b=/Safari\/(\d+)/.exec(e),f=!b||!b[1]?!0:b[1]<534)),/ Silk\//i.test(e)&&(b=/AppleWebKit\/(\d+)/.exec(e),f=!b||!b[1]?!0:b[1]<534),/iPhone|iPod|iPad/i.test(e)&&(f=!/OS [5-9](_\d)+ like Mac OS X/i.test(e)),/fennec/i.test(e)&&(f=!1),!f}(),a.sceditor.regexEscape=function(a){return a.replace(/[\$\?\[\]\.\*\(\)\|\\]/g,"\\$&").replace("<","&lt;").replace(">","&gt;")},a.sceditor.escapeEntities=function(a){return a?a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ {2}/g," &nbsp;").replace(/\r\n|\r/g,"\n").replace(/\n/g,"<br />"):a},a.sceditor.locale={},a.sceditor.commands={bold:{exec:"bold",tooltip:"Bold"},italic:{exec:"italic",tooltip:"Italic"},underline:{exec:"underline",tooltip:"Underline"},strike:{exec:"strikethrough",tooltip:"Strikethrough"},subscript:{exec:"subscript",tooltip:"Subscript"},superscript:{exec:"superscript",tooltip:"Superscript"},left:{exec:"justifyleft",tooltip:"Align left"},center:{exec:"justifycenter",tooltip:"Center"},right:{exec:"justifyright",tooltip:"Align right"},justify:{exec:"justifyfull",tooltip:"Justify"},font:{_dropDown:function(b,c,d){var f=b.opts.fonts.split(","),g=a("<div />"),h=function(){return d(a(this).data("font")),b.closeDropDown(!0),!1};for(var i=0;i<f.length;i++)g.append(e("fontOpt",{font:f[i]},!0).click(h));b.createDropDown(c,"font-picker",g)},exec:function(b){var c=this;a.sceditor.command.get("font")._dropDown(c,b,function(a){c.execCommand("fontname",a)})},tooltip:"Font Name"},size:{_dropDown:function(b,c,d){var f=a("<div />"),g=function(c){d(a(this).data("size")),b.closeDropDown(!0),c.preventDefault()};for(var h=1;h<=7;h++)f.append(e("sizeOpt",{size:h},!0).click(g));b.createDropDown(c,"fontsize-picker",f)},exec:function(b){var c=this;a.sceditor.command.get("size")._dropDown(c,b,function(a){c.execCommand("fontsize",a)})},tooltip:"Font Size"},color:{_dropDown:function(b,c,d){var e,f,g,h,i={r:255,g:255,b:255},j=a("<div />"),k=b.opts.colors?b.opts.colors.split("|"):new Array(21),l=[],m=a.sceditor.command.get("color");if(!m._htmlCache){for(e=0;e<k.length;++e){h=k[e]?k[e].split(","):new Array(21),l.push('<div class="sceditor-color-column">');for(f=0;f<h.length;++f)g=h[f]||"#"+i.r.toString(16)+i.g.toString(16)+i.b.toString(16),l.push('<a href="#" class="sceditor-color-option" style="background-color: '+g+'" data-color="'+g+'"></a>'),f%5===0?(i.g-=51,i.b=255):i.b-=51;l.push("</div>"),e%5===0?(i.r-=51,i.g=255,i.b=255):(i.g=255,i.b=255)}m._htmlCache=l.join("")}j.append(m._htmlCache).find("a").click(function(c){d(a(this).attr("data-color")),b.closeDropDown(!0),c.preventDefault()}),b.createDropDown(c,"color-picker",j)},exec:function(b){var c=this;a.sceditor.command.get("color")._dropDown(c,b,function(a){c.execCommand("forecolor",a)})},tooltip:"Font Color"},removeformat:{exec:"removeformat",tooltip:"Remove Formatting"},cut:{exec:"cut",tooltip:"Cut",errorMessage:"Your browser does not allow the cut command. Please use the keyboard shortcut Ctrl/Cmd-X"},copy:{exec:"copy",tooltip:"Copy",errorMessage:"Your browser does not allow the copy command. Please use the keyboard shortcut Ctrl/Cmd-C"},paste:{exec:"paste",tooltip:"Paste",errorMessage:"Your browser does not allow the paste command. Please use the keyboard shortcut Ctrl/Cmd-V"},pastetext:{exec:function(a){var b,c=this,d=e("pastetext",{label:c._("Paste your text inside the following box:"),insert:c._("Insert")},!0);d.find(".button").click(function(a){b=d.find("#txt").val(),b&&c.wysiwygEditorInsertText(b),c.closeDropDown(!0),a.preventDefault()}),c.createDropDown(a,"pastetext",d)},tooltip:"Paste Text"},bulletlist:{exec:"insertunorderedlist",tooltip:"Bullet list"},orderedlist:{exec:"insertorderedlist",tooltip:"Numbered list"},table:{exec:function(b){var c=this,d=e("table",{rows:c._("Rows:"),cols:c._("Cols:"),insert:c._("Insert")},!0);d.find(".button").click(function(b){var e=d.find("#rows").val()-0,f=d.find("#cols").val()-0,g="<table>";if(e<1||f<1)return;for(var h=0;h<e;h++){g+="<tr>";for(var i=0;i<f;i++)g+="<td>"+(a.sceditor.ie?"":"<br />")+"</td>";g+="</tr>"}g+="</table>",c.wysiwygEditorInsertHtml(g),c.closeDropDown(!0),b.preventDefault()}),c.createDropDown(b,"inserttable",d)},tooltip:"Insert a table"},horizontalrule:{exec:"inserthorizontalrule",tooltip:"Insert a horizontal rule"},code:{forceNewLineAfter:["code"],exec:function(){this.wysiwygEditorInsertHtml("<code>","<br /></code>")},tooltip:"Code"},image:{exec:function(a){var b=this,c=e("image",{url:b._("URL:"),width:b._("Width (optional):"),height:b._("Height (optional):"),insert:b._("Insert")},!0);c.find(".button").click(function(a){var d=c.find("#image").val(),e=c.find("#width").val(),f=c.find("#height").val(),g="";e&&(g+=' width="'+e+'"'),f&&(g+=' height="'+f+'"'),d&&d!=="http://"&&b.wysiwygEditorInsertHtml("<img"+g+' src="'+d+'" />'),b.closeDropDown(!0),a.preventDefault()}),b.createDropDown(a,"insertimage",c)},tooltip:"Insert an image"},email:{exec:function(a){var b=this,c=e("email",{label:b._("E-mail:"),insert:b._("Insert")},!0);c.find(".button").click(function(a){var d=c.find("#email").val();d&&(b.focus(),b.getRangeHelper().selectedHtml()?b.execCommand("createlink","mailto:"+d):b.wysiwygEditorInsertHtml('<a href="mailto:'+d+'">'+d+"</a>")),b.closeDropDown(!0),a.preventDefault()}),b.createDropDown(a,"insertemail",c)},tooltip:"Insert an email"},link:{exec:function(a){var b=this,c=e("link",{url:b._("URL:"),desc:b._("Description (optional):"),ins:b._("Insert")},!0);c.find(".button").click(function(a){var d=c.find("#link").val(),e=c.find("#des").val();d&&d!=="http://"&&(b.focus(),!b.getRangeHelper().selectedHtml()||e?(e||(e=d),b.wysiwygEditorInsertHtml('<a href="'+d+'">'+e+"</a>")):b.execCommand("createlink",d)),b.closeDropDown(!0),a.preventDefault()}),b.createDropDown(a,"insertlink",c)},tooltip:"Insert a link"},unlink:{exec:"unlink",tooltip:"Unlink"},quote:{forceNewLineAfter:["blockquote"],exec:function(a,b,c){var d="<blockquote>",e="</blockquote>";b?(c=c?"<cite>"+c+"</cite>":"",d=d+c+b+e+"<br />",e=null):this.getRangeHelper().selectedHtml()===""&&(e="<br />"+e),this.wysiwygEditorInsertHtml(d,e)},tooltip:"Insert a Quote"},emoticon:{exec:function(b){var c,d=this,e=d.opts.emoticonsCompat?" ":"",f=a("<div />"),g=a("<div />");c=function(b,c){g.append(a("<img />").attr({src:a.isPlainObject(c)?c.url:c,alt:b,title:a.isPlainObject(c)?c.tooltip||b:b}).click(function(b){d.insert(a(this).attr("alt")+e),d.closeDropDown(!0),b.preventDefault()})),g.children().length>3&&(f.append(g),g=a("<div />"))},a.each(d.opts.emoticons.dropdown,c),g.children().length>0&&f.append(g);if(d.opts.emoticons.more){var h=a(this._('<a class="sceditor-more">{0}</a>',this._("More"))).click(function(){var e=a.extend({},d.opts.emoticons.dropdown,d.opts.emoticons.more);return f=a("<div />"),a.each(e,c),g.children().length>0&&f.append(g),d.createDropDown(b,"insertemoticon",f),!1});f.append(h)}d.createDropDown(b,"insertemoticon",f)},txtExec:function(b){a.sceditor.command.get("emoticon").exec.call(this,b)},tooltip:"Insert an emoticon"},youtube:{_dropDown:function(a,b,c){var d,f=e("youtubeMenu",{label:a._("Video URL:"),insert:a._("Insert")},!0);f.find(".button").click(function(b){var e=f.find("#link").val().replace("http://","");e!==""&&(d=e.match(/(?:v=|v\/|embed\/|youtu.be\/)(.{11})/),d&&(e=d[1]),/^[a-zA-Z0-9_\-]{11}$/.test(e)?c(e):alert("Invalid YouTube video")),a.closeDropDown(!0),b.preventDefault()}),a.createDropDown(b,"insertlink",f)},exec:function(b){var c=this;a.sceditor.command.get("youtube")._dropDown(c,b,function(a){c.wysiwygEditorInsertHtml(e("youtube",{id:a}))})},tooltip:"Insert a YouTube video"},date:{_date:function(a){var b=new Date,c=b.getYear(),d=b.getMonth()+1,e=b.getDate();return c<2e3&&(c=1900+c),d<10&&(d="0"+d),e<10&&(e="0"+e),a.opts.dateFormat.replace(/year/i,c).replace(/month/i,d).replace(/day/i,e)},exec:function(){this.insertText(a.sceditor.command.get("date")._date(this))},txtExec:function(){this.insertText(a.sceditor.command.get("date")._date(this))},tooltip:"Insert current date"},time:{_time:function(){var a=new Date,b=a.getHours(),c=a.getMinutes(),d=a.getSeconds();return b<10&&(b="0"+b),c<10&&(c="0"+c),d<10&&(d="0"+d),b+":"+c+":"+d},exec:function(){this.insertText(a.sceditor.command.get("time")._time())},txtExec:function(){this.insertText(a.sceditor.command.get("time")._time())},tooltip:"Insert current time"},ltr:{state:function(a,b){return b&&b.style.direction==="ltr"},exec:function(){var b=this,c=b.getRangeHelper().getFirstBlockParent(),d=a(c);b.focus();if(!c||d.is("body")){b.execCommand("formatBlock","p"),c=b.getRangeHelper().getFirstBlockParent(),d=a(c);if(!c||d.is("body"))return}d.css("direction")==="ltr"?d.css("direction",""):d.css("direction","ltr")},tooltip:"Left-to-Right"},rtl:{state:function(a,b){return b&&b.style.direction==="rtl"},exec:function(){var b=this,c=b.getRangeHelper().getFirstBlockParent(),d=a(c);b.focus();if(!c||d.is("body")){b.execCommand("formatBlock","p"),c=b.getRangeHelper().getFirstBlockParent(),d=a(c);if(!c||d.is("body"))return}d.css("direction")==="rtl"?d.css("direction",""):d.css("direction","rtl")},tooltip:"Right-to-Left"},print:{exec:"print",tooltip:"Print"},maximize:{state:function(){return this.maximize()},exec:function(){this.maximize(!this.maximize())},txtExec:function(){this.maximize(!this.maximize())},tooltip:"Maximize"},source:{exec:function(){this.toggleSourceMode(),this.blur()},txtExec:function(){this.toggleSourceMode(),this.blur()},tooltip:"View source"},ignore:{}},a.sceditor.rangeHelper=function(b,c){var d,e,f,g,h,i,j=!0,k="sceditor-start-marker",l="sceditor-end-marker",m="character",n=this;f=function(a,b){e=b||a.contentDocument||a.document,d=a,j=!!a.getSelection}(b,c),n.insertHTML=function(a,b){var c,d,f=n.selectedRange();b&&(a+=n.selectedHtml()+b);if(j){d=e.createElement("div"),c=e.createDocumentFragment(),d.innerHTML=a;while(d.firstChild)c.appendChild(d.firstChild);n.insertNode(c)}else{if(!f)return!1;f.pasteHTML(a)}},n.insertNode=function(a,b){if(j){var c,d,f=e.createDocumentFragment(),g=n.selectedRange();if(!g)return!1;f.appendChild(a),b&&(f.appendChild(g.extractContents()),f.appendChild(b)),d=f.lastChild,g.deleteContents(),g.insertNode(f),c=e.createRange(),c.setStartAfter(d),n.selectRange(c)}else n.insertHTML(a.outerHTML,b?b.outerHTML:null)},n.cloneSelected=function(){var a=n.selectedRange();if(a)return j?a.cloneRange():a.duplicate()},n.selectedRange=function(){var a,b,c=j?d.getSelection():e.selection;if(!c)return;c.getRangeAt&&c.rangeCount<=0&&(a=e.createRange(),a.setStart(e.body,0),c.addRange(a)),a=j?c.getRangeAt(0):c.createRange();if(a.parentElement&&(b=a.parentElement())&&b.ownerDocument!==e)return;return a},n.selectedHtml=function(){var a,b=n.selectedRange();return b?!j&&b.text!==""&&b.htmlText?b.htmlText:j?(a=e.createElement("div"),a.appendChild(b.cloneContents()),a.innerHTML):"":""},n.parentNode=function(){var a=n.selectedRange();if(a){if(j)return a.commonAncestorContainer;if(a.parentElement)return a.parentElement()}},n.getFirstBlockParent=function(b){var c=function(b){if(!a.sceditor.dom.isInline(b))return b;var d=b?b.parentNode:null;return d?c(d):null};return c(b||n.parentNode
())},n.insertNodeAt=function(a,b){var c=n.selectedRange(),d=n.cloneSelected();if(!d)return!1;d.collapse(a),d.insertNode?d.insertNode(b):d.pasteHTML(b.outerHTML),n.selectRange(c)},g=function(a){n.removeMarker(a);var b=e.createElement("span");return b.id=a,b.style.lineHeight="0",b.style.display="none",b.className="sceditor-selection",b},n.insertMarkers=function(){n.insertNodeAt(!0,g(k)),n.insertNodeAt(!1,g(l))},n.getMarker=function(a){return e.getElementById(a)},n.removeMarker=function(a){var b=n.getMarker(a);b&&b.parentNode.removeChild(b)},n.removeMarkers=function(){n.removeMarker(k),n.removeMarker(l)},n.saveRange=function(){n.insertMarkers()},n.selectRange=function(a){j?(d.getSelection().removeAllRanges(),d.getSelection().addRange(a)):a.select()},n.restoreRange=function(){var a,b=n.selectedRange(),c=n.getMarker(k),d=n.getMarker(l);if(!c||!d||!b)return!1;j?(b=e.createRange(),b.setStartBefore(c),b.setEndAfter(d),n.selectRange(b)):(b=e.body.createTextRange(),a=e.body.createTextRange(),a.moveToElementText(c),b.setEndPoint("StartToStart",a),b.moveStart(m,0),a.moveToElementText(d),b.setEndPoint("EndToStart",a),b.moveEnd(m,0),n.selectRange(b)),n.removeMarkers()},i=function(a,b){var c=n.cloneSelected();if(!c)return!1;c.collapse(!1),j?(c.setStart(c.startContainer,c.startOffset-a),c.setEnd(c.endContainer,c.endOffset+b)):(c.moveStart(m,0-a),c.moveEnd(m,b)),n.selectRange(c)},h=function(a,b){var c="",d=n.cloneSelected();return d?(d.collapse(!1),a?j?(c=d.startContainer.textContent.substr(0,d.startOffset),c=c.substr(Math.max(0,c.length-b))):(d.moveStart(m,0-b),c=d.text):j?c=d.startContainer.textContent.substr(d.startOffset,b):(d.moveEnd(m,b),c=d.text),c):""},n.raplaceKeyword=function(b,c,d,e,f,g){d||b.sort(function(a,b){return a.length-b.length});var k,l,m,o,p,q,r,s,t=e||b[b.length-1][0].length;k=l=m="";if(f){if(!j)return!1;++t}k=h(!0,t),c&&(l=h(!1,t)),m=k+(g!=null?g:"")+l,o=b.length;while(o--){r=new RegExp("(?:[\\s    ])"+a.sceditor.regexEscape(b[o][0])+"(?=[\\s    ])"),s=k.length-1-b[o][0].length,f&&--s,s=Math.max(0,s);if(!f&&(p=m.indexOf(b[o][0],s))>-1||f&&(p=m.substr(s).search(r))>-1){f&&(p+=s+1);if(p>k.length||p+b[o][0].length+(f?1:0)<k.length)continue;return q=k.length-p,i(q,b[o][0].length-q-(g!=null&&/^\S/.test(g)?1:0)),n.insertHTML(b[o][1]),!0}}return!1},n.compare=function(a,b){return b||(b=n.selectedRange()),!a||!b?!a&&!b:j?a.compareBoundaryPoints(Range.END_TO_END,b)===0&&a.compareBoundaryPoints(Range.START_TO_START,b)===0:a.compareEndPoints("EndToEnd",b)===0&&a.compareEndPoints("StartToStart",b)===0}},a.sceditor.dom={traverse:function(a,b,c,d,e){if(a){a=e?a.lastChild:a.firstChild;while(a!=null){var f=e?a.previousSibling:a.nextSibling;if(!c&&b(a)===!1)return!1;if(!d&&this.traverse(a,b,c,d,e)===!1)return!1;if(c&&b(a)===!1)return!1;a=f}}},rTraverse:function(a,b,c,d){this.traverse(a,b,c,d,!0)},blockLevelList:"|body|hr|p|div|h1|h2|h3|h4|h5|h6|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|blockquote|center|",isInline:function(b,c){return!b||b.nodeType!==1?!0:(b=b.tagName.toLowerCase(),b==="code"?!c:a.sceditor.dom.blockLevelList.indexOf("|"+b+"|")<0)},copyCSS:function(a,b){b.style.cssText=a.style.cssText+b.style.cssText},fixNesting:function(a){var b=this,c=function(a){while(b.isInline(a.parentNode,!0))a=a.parentNode;return a};b.traverse(a,function(a){if(a.nodeType===1&&!b.isInline(a,!0)&&b.isInline(a.parentNode,!0)){var d=c(a),e=d.parentNode,f=b.extractContents(d,a),g=a;b.copyCSS(d,g),e.insertBefore(f,d),e.insertBefore(g,d)}})},findCommonAncestor:function(b,c){return a(b).parents().has(a(c)).first()},removeWhiteSpace:function(b){var c,d=/[^\S|\u00A0]+/g;this.traverse(b,function(b){c=b.nodeValue;if(b.nodeType===3&&a(b).parents("code, pre").length===0&&c){if(!b.previousSibling||!a.sceditor.dom.isInline(b.previousSibling))c=c.replace(/^[\r\n]+/,"");if(!b.nextSibling||!a.sceditor.dom.isInline(b.nextSibling))c=c.replace(/[\r\n]+$/,"");c=c.replace(/[\r\n]+/," ");if(!c.length){b.parentNode.removeChild(b);return}/\S|\u00A0/.test(c)?d.test(c)&&(c=c.replace(d," ")):c=" ",b.nodeValue=c}})},extractContents:function(a,b){var c=this,d=c.findCommonAncestor(a,b),e=d?d.get(0):null,f=!1,g=!1;return function h(d){var e=a.ownerDocument.createDocumentFragment();return c.traverse(d,function(c){if(g||c===b&&f)return g=!0,!1;c===a&&(f=!0);var d,i;f?jQuery.contains(c,b)&&c.nodeType===1?(d=h(c),i=c.cloneNode(!1),i.appendChild(d),e.appendChild(i)):e.appendChild(c):jQuery.contains(c,a)&&c.nodeType===1&&(d=h(c),i=c.cloneNode(!1),i.appendChild(d),e.appendChild(i))},!1),e}(e)}},a.sceditor.plugins={},a.sceditor.PluginManager=function(b){var c=this,d=[],e=b,f=function(a){return"signal"+a.charAt(0).toUpperCase()+a.slice(1)},g=function(a,b){a=[].slice.call(a);var c=d.length,g=f(a.shift());while(c--)if(g in d[c]){if(b)return d[c][g].apply(e,a);d[c][g].apply(e,a)}};c.call=function(){g(arguments,!1)},c.callOnlyFirst=function(){return g(arguments,!0)},c.iter=function(a){return a=f(a),function(){var b=d.length;return{callNext:function(c){while(b--)if(d[b]&&a in d[b])return d[b].apply(e,c)},hasNext:function(){var c=b;while(c--)if(d[c]&&a in d[c])return!0;return!1}}}()},c.hasHandler=function(a){var b=d.length;a=f(a);while(b--)if(a in d[b])return!0;return!1},c.exsists=function(b){return b in a.sceditor.plugins?(b=a.sceditor.plugins[b],typeof b=="function"&&typeof b.prototype=="object"):!1},c.isRegistered=function(b){var e=d.length;if(!c.exsists(b))return!1;while(e--)if(d[e]instanceof a.sceditor.plugins[b])return!0;return!1},c.register=function(b){return c.exsists(b)?(b=new a.sceditor.plugins[b],d.push(b),"init"in b&&b.init.apply(e),!0):!1},c.deregister=function(b){var f,g=d.length,h=!1;if(!c.isRegistered(b))return!1;while(g--)d[g]instanceof a.sceditor.plugins[b]&&(f=d.splice(g,1)[0],h=!0,"destroy"in f&&f.destroy.apply(e));return h},c.destroy=function(){var a=d.length;while(a--)"destroy"in d[a]&&d[a].destroy.apply(e);d=null,e=null}},a.sceditor.command={get:function(b){return a.sceditor.commands[b]||null},set:function(b,c){return!b||!c?!1:(c=a.extend(a.sceditor.commands[b]||{},c),c.remove=function(){a.sceditor.command.remove(b)},a.sceditor.commands[b]=c,this)},remove:function(b){return a.sceditor.commands[b]&&delete a.sceditor.commands[b],this}},a.sceditor.defaultOptions={toolbar:"bold,italic,underline,strike,subscript,superscript|left,center,right,justify|font,size,color,removeformat|cut,copy,paste,pastetext|bulletlist,orderedlist|table|code,quote|horizontalrule,image,email,link,unlink|emoticon,youtube,date,time|ltr,rtl|print,maximize,source",style:"jquery.sceditor.default.css",fonts:"Arial,Arial Black,Comic Sans MS,Courier New,Georgia,Impact,Sans-serif,Serif,Times New Roman,Trebuchet MS,Verdana",colors:null,locale:"en",charset:"utf-8",emoticonsCompat:!1,emoticonsEnabled:!0,emoticonsRoot:"",emoticons:{dropdown:{":)":"emoticons/smile.png",":angel:":"emoticons/angel.png",":angry:":"emoticons/angry.png","8-)":"emoticons/cool.png",":'(":"emoticons/cwy.png",":ermm:":"emoticons/ermm.png",":D":"emoticons/grin.png","<3":"emoticons/heart.png",":(":"emoticons/sad.png",":O":"emoticons/shocked.png",":P":"emoticons/tongue.png",";)":"emoticons/wink.png"},more:{":alien:":"emoticons/alien.png",":blink:":"emoticons/blink.png",":blush:":"emoticons/blush.png",":cheerful:":"emoticons/cheerful.png",":devil:":"emoticons/devil.png",":dizzy:":"emoticons/dizzy.png",":getlost:":"emoticons/getlost.png",":happy:":"emoticons/happy.png",":kissing:":"emoticons/kissing.png",":ninja:":"emoticons/ninja.png",":pinch:":"emoticons/pinch.png",":pouty:":"emoticons/pouty.png",":sick:":"emoticons/sick.png",":sideways:":"emoticons/sideways.png",":silly:":"emoticons/silly.png",":sleeping:":"emoticons/sleeping.png",":unsure:":"emoticons/unsure.png",":woot:":"emoticons/w00t.png",":wassat:":"emoticons/wassat.png"},hidden:{":whistling:":"emoticons/whistling.png",":love:":"emoticons/wub.png"}},width:null,height:null,resizeEnabled:!0,resizeMinWidth:null,resizeMinHeight:null,resizeMaxHeight:null,resizeMaxWidth:null,resizeHeight:!0,resizeWidth:!0,getHtmlHandler:null,getTextHandler:null,dateFormat:"year-month-day",toolbarContainer:null,enablePasteFiltering:!1,disablePasting:!1,readOnly:!1,rtl:!1,autofocus:!1,autofocusEnd:!0,autoExpand:!1,autoUpdate:!1,runWithoutWysiwygSupport:!1,id:null,plugins:"",zIndex:null,parserOptions:{},dropDownCss:{}},a.fn.sceditor=function(b){var c,d=[];b=b||{};if(!b.runWithoutWysiwygSupport&&!a.sceditor.isWysiwygSupported)return;return this.each(function(){c=this.jquery?this:a(this);if(c.parents(".sceditor-container").length>0)return;b==="state"?d.push(!!c.data("sceditor")):b==="instance"?d.push(c.data("sceditor")):c.data("sceditor")||new a.sceditor(this,b)}),d.length?d.length===1?d[0]:a(d):this}})(jQuery,window,document),function(a,b,c){"use strict",a.sceditor.BBCodeParser=function(b){if(!(this instanceof a.sceditor.BBCodeParser))return new a.sceditor.BBCodeParser(b);var d=this,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t={open:"open",content:"content",newline:"newline",close:"close"};Object.freeze&&Object.freeze(t);var u=function(a,b,c,d,e,f){var g=this;g.type=a,g.name=b,g.val=c,g.attrs=d||{},g.children=e||[],g.closing=f||null};u.prototype={clone:function(a){var b=this;return new u(b.type,b.name,b.val,b.attrs,a?b.children:[],b.closing?b.closing.clone():null)},splitAt:function(b){var c,d=this,e=0,f=d.children.length;typeof object!="number"&&(b=a.inArray(b,d.children));if(b<0||b>f)return null;while(f--)f>=b?e++:f=!1;return c=d.clone(),c.children=d.children.splice(b,e),c}},e=function(){d.opts=a.extend({},a.sceditor.BBCodeParser.defaults,b),d.bbcodes=a.sceditorBBCodePlugin.bbcodes},d.tokenize=function(a){var b,c,d,e=[],g=[{type:"close",regex:/^\[\/[^\[\]]+\]/},{type:"open",regex:/^\[[^\[\]]+\]/},{type:"newline",regex:/^(\r\n|\r|\n)/},{type:"content",regex:/^([^\[\r\n]+|\[)/}];g.reverse();a:while(a.length){d=g.length;while(d--){c=g[d].type;if(!(b=a.match(g[d].regex))||!b[0])continue;e.push(f(c,b[0])),a=a.substr(b[0].length);continue a}a.length&&e.push(f(t.content,a)),a=""}return e},f=function(b,c){var d,e,f;return b==="open"?(d=c.match(/\[([^\]\s=]+)(?:([^\]]+))?\]/),d?(f=r(d[1]),d[2]&&(d[2]=a.trim(d[2]))&&(e=g(d[2]))):(b="content",f="#")):b==="close"?(d=c.match(/\[\/([^\[\]]+)\]/),d?f=r(d[1]):(b="content",f="#")):b==="newline"?f="#newline":f="#",new u(b,f,c,e)},g=function(b){var c,d,e=/([^\s=]+)=(?:(?:(["'])((?:\\\2|[^\2])*?)\2)|((?:.(?!\s\S+=))*.))/g,f={};d=function(a,b){return b&&(a=a.replace("\\\\","\\").replace("\\"+b,b)),a};if(b.charAt(0)==="="&&b.split("=").length<=2)f.defaultattr=a.sceditorBBCodePlugin.stripQuotes(b.substr(1));else{b.charAt(0)==="="&&(b="defaultattr"+b);while(c=e.exec(b))f[r(c[1])]=d(c[3],c[2])||c[4]}return f},d.parse=function(a,b){var c=h(d.tokenize(a));return d.opts.fixInvalidChildren&&m(c),d.opts.removeEmptyTags&&l(c),d.opts.fixInvalidNesting&&j(c),i(c,null,b),d.opts.removeEmptyTags&&l(c),c},p=function(a,b,c){var d=c.length;while(d--)if(c[d].type===b&&c[d].name===a)return!0;return!1},k=function(b,c){var e=b?d.bbcodes[b.name]:null,f=e?e.allowedChildren:null;return!d.opts.fixInvalidChildren||!f?!0:f&&a.inArray(c.name||"#",f)<0?!1:!0},h=function(b){var c,e,f,g,h,i,j,k=[],l=[],m=[],n=function(){return s(m)},o=function(a){n()?n().children.push(a):l.push(a)},q=function(b){return n()&&(e=d.bbcodes[n().name])&&e.closedBy&&a.inArray(b,e.closedBy)>-1};while(c=b.shift()){j=b[0];switch(c.type){case t.open:q(c.name)&&m.pop(),o(c),e=d.bbcodes[c.name],(!e||!e.isSelfClosing)&&(e||p(c.name,t.close,b))&&m.push(c);break;case t.close:n()&&c.name!==n().name&&q("/"+c.name)&&m.pop();if(n()&&c.name===n().name)n().closing=c,m.pop();else if(p(c.name,t.open,m)){while(f=m.pop()){if(f.name===c.name){f.closing=c;break}g=f.clone(),k.length>1&&g.children.push(s(k)),k.push(g)}o(s(k)),h=k.length;while(h--)m.push(k[h]);k.length=0}else c.type=t.content,o(c);break;case t.newline:n()&&j&&q((j.type===t.close?"/":"")+j.name)&&(j.type!==t.close||j.name!==n().name)&&(e=d.bbcodes[n().name],e&&e.breakAfter?m.pop():e&&e.isInline===!1&&d.opts.breakAfterBlock&&e.breakAfter!==!1&&m.pop()),o(c);break;default:o(c)}i=c}return l},i=function(a,b,c){var e,f,g,h,j,k,l,m,n,o=a.length,p=o;b&&(h=d.bbcodes[b.name]);while(p--){if(!(e=a[p]))continue;if(e.type===t.newline){f=p>0?a[p-1]:null,g=p<o-1?a[p+1]:null,n=!1,!c&&h&&h.isSelfClosing!==!0&&(p===0?(h.isInline===!1&&d.opts.breakStartBlock&&h.breakStart!==!1&&(n=!0),h.breakStart&&(n=!0)):!l&&o-1===p&&(h.isInline===!1&&d.opts.breakEndBlock&&h.breakEnd!==!1&&(n=!0),h.breakEnd&&(n=!0),l=n)),f&&f.type===t.open&&(j=d.bbcodes[f.name])&&(c?j.isInline===!1&&(n=!0):(j.isInline===!1&&d.opts.breakAfterBlock&&j.breakAfter!==!1&&(n=!0),j.breakAfter&&(n=!0)));if(!c&&!m&&g&&g.type===t.open)if(k=d.bbcodes[g.name]){k.isInline===!1&&d.opts.breakBeforeBlock&&k.breakBefore!==!1&&(n=!0),k.breakBefore&&(n=!0),m=n;if(n){a.splice(p,1);continue}}n&&a.splice(p,1),m=!1}else e.type===t.open&&i(e.children,e,c)}},j=function(b,c,e,f){var g,h,i,k,l,m,n=function(a){var b=d.bbcodes[a.name];return!b||b.isInline!==!1};c=c||[],f=f||b;for(h=0;h<b.length;h++){if(!(g=b[h])||g.type!==t.open)continue;if(!n(g)&&e){i=s(c),m=i.splitAt(g),l=c.length>1?c[c.length-2].children:f;if((k=a.inArray(i,l))>-1){m.children.splice(a.inArray(g,m.children),1),l.splice(k+1,0,g,m);return}}c.push(g),j(g.children,c,e||n(g),f),c.pop(g)}},m=function(a,b){var c,d,e=a.length;while(e--){if(!(c=a[e]))continue;k(b,c)||(c.name=null,c.type=t.content,k(b,c)?(d=[e+1,0].concat(c.children),c.closing&&(c.closing.name=null,c.closing.type=t.content,d.push(c.closing)),e+=d.length-1,Array.prototype.splice.apply(a,d)):b.children.splice(e,1)),c.type===t.open&&m(c.children,c)}},l=function(a){var b,c,e,f=a.length;e=function(a){var b=a.length;while(b--){if(a[b].type===t.open)return!1;if(a[b].type===t.close)return!1;if(a[b].type===t.content&&a[b].val&&/\S|\u00A0/.test(a[b].val))return!1}return!0};while(f--){if(!(b=a[f])||b.type!==t.open)continue;c=d.bbcodes[b.name],l(b.children),e(b.children)&&c&&!c.isSelfClosing&&!c.allowsEmpty&&a.splice(f,1)}},d.toHTML=function(a,b){return n(d.parse(a,b),!0)},n=function(b,e){var f,g,h,i,j,k,l,m,o=[];while(b.length>0){if(!(f=b.shift()))continue;if(f.type===t.open)g=d.bbcodes[f.name],l=!g||(typeof g.isHtmlInline!="undefined"?g.isHtmlInline:g.isInline),j=e&&(!g||l!==!1),h=n(f.children,!1),g&&g.html?(m=l===!1&&!g.isPreFormatted&&!g.skipLastLineBreak,m&&!a.sceditor.ie&&(h+="<br />"),a.isFunction(g.html)?i=g.html.call(d,f,f.attrs,h):i=a.sceditorBBCodePlugin.formatString(g.html,h)):i=f.val+h+(f.closing?f.closing.val:"");else{if(f.type===t.newline){if(!e){o.push("<br />");continue}if(k){o.push("</div>\n"),k=!1;continue}o.push("<div>"),a.sceditor.ie||o.push("<br />"),(c.documentMode&&c.documentMode<8||a.sceditor.ie<8)&&o.push(" "),o.push("</div>\n");continue}j=e,i=a.sceditor.escapeEntities(f.val)}j&&!k?(o.push("<div>"),k=!0):!j&&k&&(o.push("</div>\n"),k=!1),o.push(i)}return k&&o.push("</div>\n"),o.join("")},d.toBBCode=function(a,b){return o(d.parse(a,b))},o=function(b){var c,e,f,g,h,i,j,k,l,m,n=[];while(b.length>0){if(!(c=b.shift()))continue;f=d.bbcodes[c.name],g=!!f&&f.isInline===!1,h=f&&f.isSelfClosing,j=g&&d.opts.breakBeforeBlock&&f.breakBefore!==!1||f&&f.breakBefore,k=g&&!h&&d.opts.breakStartBlock&&f.breakStart!==!1||f&&f.breakStart,l=g&&d.opts.breakEndBlock&&f.breakEnd!==!1||f&&f.breakEnd,m=g&&d.opts.breakAfterBlock&&f.breakAfter!==!1||f&&f.breakAfter,i=(f?f.quoteType:null)||d.opts.quoteType||a.sceditor.BBCodeParser.QuoteType.auto;if(!f&&c.type===t.open)n.push(c.val),c.children&&n.push(o(c.children)),c.closing&&n.push(c.closing.val);else if(c.type===t.open){j&&n.push("\n"),n.push("["+c.name);if(c.attrs){c.attrs.defaultattr&&(n.push("="+q(c.attrs.defaultattr,i,"defaultattr")),delete c.attrs.defaultattr);for(e in c.attrs)c.attrs.hasOwnProperty(e)&&n.push(" "+e+"="+q(c.attrs[e],i,e))}n.push("]"),k&&n.push("\n"),c.children&&n.push(o(c.children)),!h&&!f.excludeClosing&&(l&&n.push("\n"),n.push("[/"+c.name+"]")),m&&n.push("\n"),c.closing&&h&&n.push(c.closing.val)}else n.push(c.val)}return n.join("")},q=function(b,c,d){var e=a.sceditor.BBCodeParser.QuoteType,f=/\s|=/.test(b);return a.isFunction(c)?c(b,d):c===e.never||c===e.auto&&!f?b:'"'+b.replace("\\","\\\\").replace('"','\\"')+'"'},s=function(a){return a.length?a[a.length-1]:null},r=function(a){return a.toLowerCase()},e()},a.sceditor.BBCodeParser.QuoteType={always:1,never:2,auto:3},Object.freeze&&Object.freeze(a.sceditor.BBCodeParser.QuoteType),a.sceditor.BBCodeParser.defaults={breakBeforeBlock:!1,breakStartBlock:!1,breakEndBlock:!1,breakAfterBlock:!0,removeEmptyTags:!0,fixInvalidNesting:!0,fixInvalidChildren:!0,quoteType:a.sceditor.BBCodeParser.QuoteType.auto},a.sceditorBBCodePlugin=a.sceditor.plugins.bbcode=function(){var b=this,d,e,f,g,h,i,j;g=a.sceditorBBCodePlugin.formatString,b.bbcodes=a.sceditorBBCodePlugin.bbcodes,b.stripQuotes=a.sceditorBBCodePlugin.stripQuotes;var k={},l={},m={ul:["li","ol","ul"],ol:["li","ol","ul"],table:["tr"],tr:["td","th"],code:["br","p","div"]},n={};b.init=function(){b.opts=this.opts,d(),i(this)},i=function(b){var c={bold:{txtExec:["[b]","[/b]"]},italic:{txtExec:["[i]","[/i]"]},underline:{txtExec:["[u]","[/u]"]},strike:{txtExec:["[s]","[/s]"]},subscript:{txtExec:["[sub]","[/sub]"]},superscript:{txtExec:["[sup]","[/sup]"]},left:{txtExec:["[left]","[/left]"]},center:{txtExec:["[center]","[/center]"]},right:{txtExec:["[right]","[/right]"]},justify:{txtExec:["[justify]","[/justify]"]},font:{txtExec:function(b){var c=this;a.sceditor.command.get("font")._dropDown(c,b,function(a){c.insertText("[font="+a+"]","[/font]")})}},size:{txtExec:function(b){var c=this;a.sceditor.command.get("size")._dropDown(c,b,function(a){c.insertText("[size="+a+"]","[/size]")})}},color:{txtExec:function(b){var c=this;a.sceditor.command.get("color")._dropDown(c,b,function(a){c.insertText("[color="+a+"]","[/color]")})}},bulletlist:{txtExec:["[ul][li]","[/li][/ul]"]},orderedlist:{txtExec:["[ol][li]","[/li][/ol]"]},table:{txtExec:["[table][tr][td]","[/td][/tr][/table]"]},horizontalrule:{txtExec:["[hr]"]},code:{txtExec:["[code]","[/code]"]},image:{txtExec:function(a,b){var c=prompt(this._("Enter the image URL:"),b);c&&this.insertText("[img]"+c+"[/img]")}},email:{txtExec:function(a,b){var c=b&&b.indexOf("@")>-1?null:b,d=prompt(this._("Enter the e-mail address:"),c?"":b),e=prompt(this._("Enter the displayed text:"),c||d)||d;d&&this.insertText("[email="+d+"]"+e+"[/email]")}},link:{txtExec:function(a,b){var c=b&&b.indexOf("http://")>-1?null:b,d=prompt(this._("Enter URL:"),c?"http://":b),e=prompt(this._("Enter the displayed text:"),c||d)||d;d&&this.insertText("[url="+d+"]"+e+"[/url]")}},quote:{txtExec:["[quote]","[/quote]"]},youtube:{txtExec:function(b){var c=this;a.sceditor.command.get("youtube")._dropDown(c,b,function(a){c.insertText("[youtube]"+a+"[/youtube]")})}},rtl:{txtExec:["[rtl]","[/rtl]"]},ltr:{txtExec:["[ltr]","[/ltr]"]}};b.commands=a.extend(!0,{},c,b.commands)},d=function(){a.each(b.bbcodes,function(c){typeof b.bbcodes[c].tags!="undefined"&&a.each(b.bbcodes[c].tags,function(a,d){var e=b.bbcodes[c].isInline===!1;k[a]=k[a]||{},k[a][e]=k[a][e]||{},k[a][e][c]=d}),typeof b.bbcodes[c].styles!="undefined"&&a.each(b.bbcodes[c].styles,function(a,d){var e=b.bbcodes[c].isInline===!1;l[e]=l[e]||{},l[e][a]=l[e][a]||{},l[e][a][c]=d})})},h=function(b,c){var d,e,f,g,h,i=b.style;return i?(n[c]||(n[c]=a.camelCase(c)),h=n[c],"text-align"===c?(d=a(b),f=i.direction,g=i[h]||d.css(c),d.parent().css(c)!==g&&d.css("display")==="block"&&!d.is("hr")&&!d.is("th")&&(e=g),f&&e&&(/right/i.test(e)&&f==="rtl"||/left/i.test(e)&&f==="ltr")?null:e):i[h]):null},e=function(c,d,e){var f;return e=!!e,l[e]?(a.each(l[e],function(e,i){f=h(c[0],e);if(!f||h(c.parent()[0],e)===f)return;a.each(i,function(e,h){if(!h||a.inArray(f.toString(),h)>-1)a.isFunction(b.bbcodes[e].format)?d=b.bbcodes[e].format.call(b,c,d):d=g(b.bbcodes[e].format,d)})}),d):d},f=function(c,d,e){var f=c[0].nodeName.toLowerCase();e=!!e,k[f]&&k[f][e]&&a.each(k[f][e],function(e,f){if(f){var h=!1;a.each(f,function(b,d){if(!c.attr(b)||d&&a.inArray(c.attr(b),d)<0)return;return h=!0,!1});if(!h)return}a.isFunction(b.bbcodes[e].format)?d=b.bbcodes[e].format.call(b,c,d):d=g(b.bbcodes[e].format,d)});if(e&&(!a.sceditor.dom.isInline(c[0],!0)||f==="br")){var h=c[0].parentNode,i=c[0].previousSibling,j=a.sceditor.dom.isInline(h,!0)||h.nodeName.toLowerCase()==="body";if(j||f==="li"||h.lastChild!==c[0]||f==="br"&&a.sceditor.ie)d+="\n";"br"!==f&&!j&&i&&i.nodeType===3&&(d="\n"+d)}return d},b.signalToSource=function(c,d){var e=new a.sceditor.BBCodeParser(b.opts.parserOptions);return a.sceditor.dom.removeWhiteSpace(d[0]),a.trim(e.toBBCode(b.elementToBbcode(d),!0))},b.elementToBbcode=function(b){return function c(b,d){var g="";return a.sceditor.dom.traverse(b,function(b){var h=a(b),i="",j=b.nodeType,k=b.nodeName.toLowerCase(),l=m[k],n=!0;typeof d=="object"&&(n=a.inArray(k,d)>-1,n||(l=d));if(j!==3&&j!==1)return;if(j===1){if(h.hasClass("sceditor-ignore"))return;k!=="iframe"&&(i=c(b,l)),n?(k!=="code"&&(i=e(h,i),i=f(h,i),i=e(h,i,!0)),g+=f(h,i,!0)):g+=i}else b.wholeText&&(!b.previousSibling||b.previousSibling.nodeType!==3)?h.parents("code").length===0?g+=b.wholeText.replace(/ +/g," "):g+=b.wholeText:b.wholeText||(g+=b.nodeValue)},!1,!0),g}(b.get(0))},b.signalToWysiwyg=function(c,d){var e=new a.sceditor.BBCodeParser(b.opts.parserOptions),f=e.toHTML(c);return d?j(f):f},j=function(b){var d,e,f,g=a("<div />").hide().appendTo(c.body),h=g[0];return f=function(b){while(e=b.firstChild)h.insertBefore(e,b);a.sceditor.ie>=9&&h.insertBefore(c.createElement("br"),b),h.removeChild(b)},h.innerHTML=b.replace(/<\/div>\n/g,"</div>"),d=h.firstChild,d&&d.nodeName.toLowerCase()==="div"&&f(d),d=h.lastChild,d&&d.nodeName.toLowerCase()==="div"&&f(d),h=h.innerHTML,g.remove(),h}},a.sceditorBBCodePlugin.stripQuotes=function(a){return a.replace(/^(["'])(.*?)\1$/,"$2")},a.sceditorBBCodePlugin.formatString=function(){var a=arguments;return a[0].replace(/\{(\d+)\}/g,function(b,c){return typeof a[c-0+1]!="undefined"?a[c-0+1]:"{"+c+"}"})},a.sceditorBBCodePlugin.normaliseColour=function(a){function c(a){return a=parseInt(a,10),isNaN(a)?"00":(a=Math.max(0,Math.min(a,255)).toString(16),a.length<2?"0"+a:a)}var b;return(b=a.match(/rgb\((\d{1,3}),\s*?(\d{1,3}),\s*?(\d{1,3})\)/i))?"#"+c(b[1])+c(b[2]-0)+c(b[3]-0):(b=a.match(/#([0-f])([0-f])([0-f])\s*?$/i))?"#"+b[1]+b[1]+b[2]+b[2]+b[3]+b[3]:a},a.sceditorBBCodePlugin.bbcodes={b:{tags:{b:null,strong:null},styles:{"font-weight":["bold","bolder","401","700","800","900"]},format:"[b]{0}[/b]",html:"<strong>{0}</strong>"},i:{tags:{i:null,em:null},styles:{"font-style":["italic","oblique"]},format:"[i]{0}[/i]",html:"<em>{0}</em>"},u:{tags:{u:null},styles:{"text-decoration":["underline"]},format:"[u]{0}[/u]",html:"<u>{0}</u>"},s:{tags:{s:null,strike:null},styles:{"text-decoration":["line-through"]},format:"[s]{0}[/s]",html:"<s>{0}</s>"},sub:{tags:{sub:null},format:"[sub]{0}[/sub]",html:"<sub>{0}</sub>"},sup:{tags:{sup:null},format:"[sup]{0}[/sup]",html:"<sup>{0}</sup>"},font:{tags:{font:{face:null}},styles:{"font-family":null},quoteType:a.sceditor.BBCodeParser.QuoteType.never,format:function(a,b){var c;if(a[0].nodeName.toLowerCase()!=="font"||!(c=a.attr("face")))c=a.css("font-family");return"[font="+this.stripQuotes(c)+"]"+b+"[/font]"},html:function(a,b,c){return'<font face="'+b.defaultattr+'">'+c+"</font>"}},size:{tags:{font:{size:null}},styles:{"font-size":null},format:function(a,b){var c=a.attr("size"),d=1;return c||(c=a.css("fontSize")),c.indexOf("px")>-1?(c=c.replace("px","")-0,c>12&&(d=2),c>15&&(d=3),c>17&&(d=4),c>23&&(d=5),c>31&&(d=6),c>47&&(d=7)):d=c,"[size="+d+"]"+b+"[/size]"},html:function(a,b,c){return'<font size="'+b.defaultattr+'">'+c+"</font>"}},color:{tags:{font:{color:null}},styles:{color:null},quoteType:a.sceditor.BBCodeParser.QuoteType.never,format:function(b,c){var d,e=b[0];if(e.nodeName.toLowerCase()!=="font"||!(d=b.attr("color")))d=e.style.color||b.css("color");return"[color="+a.sceditorBBCodePlugin.normaliseColour(d)+"]"+c+"[/color]"},html:function(a,b,c){return'<font color="'+b.defaultattr+'">'+c+"</font>"}},ul:{tags:{ul:null},breakStart:!0,isInline:!1,skipLastLineBreak:!0,format:"[ul]{0}[/ul]",html:"<ul>{0}</ul>"},list:{breakStart:!0,isInline:!1,skipLastLineBreak:!0,html:"<ul>{0}</ul>"},ol:{tags:{ol:null},breakStart:!0,isInline:!1,skipLastLineBreak:!0,format:"[ol]{0}[/ol]",html:"<ol>{0}</ol>"},li:{tags:{li:null},isInline:!1,closedBy:["/ul","/ol","/list","*","li"],format:"[li]{0}[/li]",html:"<li>{0}</li>"},"*":{isInline:!1,closedBy:["/ul","/ol","/list","*","li"],html:"<li>{0}</li>"},table:{tags:{table:null},isInline:!1,isHtmlInline:!0,skipLastLineBreak:!0,format:"[table]{0}[/table]",html:"<table>{0}</table>"},tr:{tags:{tr:null},isInline:!1,skipLastLineBreak:!0,format:"[tr]{0}[/tr]",html:"<tr>{0}</tr>"},th:{tags:{th:null},allowsEmpty:!0,isInline:!1,format:"[th]{0}[/th]",html:"<th>{0}</th>"},td:{tags:{td:null},allowsEmpty:!0,isInline:!1,format:"[td]{0}[/td]",html:"<td>{0}</td>"},emoticon:{allowsEmpty:!0,tags:{img:{src:null,"data-sceditor-emoticon":null}},format:function(a,b){return a.attr("data-sceditor-emoticon")+b},html:"{0}"},hr:{tags:{hr:null},allowsEmpty:!0,isSelfClosing:!0,isInline:!1,format:"[hr]{0}",html:"<hr />"},img:{allowsEmpty:!0,tags:{img:{src:null}},quoteType:a.sceditor.BBCodeParser.QuoteType.never,format:function(b,c){var d="",e=function(a){return b.style?b.style[a]:null};if(typeof b.attr("data-sceditor-emoticon")!="undefined")return c;if(b.attr("width")||b.attr("height")||e("width")||e("height"))d="="+a(b).width()+"x"+a(b).height();return"[img"+d+"]"+b.attr("src")+"[/img]"},html:function(a,b,c){var d,e="";return typeof b.width!="undefined"&&(e+=' width="'+b.width+'"'),typeof b.height!="undefined"&&(e+=' height="'+b.height+'"'),typeof b.defaultattr!="undefined"&&(d=b.defaultattr.split(/x/i),e=' width="'+d[0]+'"'+' height="'+(d.length===2?d[1]:d[0])+'"'),"<img"+e+' src="'+c+'" />'}},url:{allowsEmpty:!0,tags:{a:{href:null}},quoteType:a.sceditor.BBCodeParser.QuoteType.never,format:function(a,b){var c=a.attr("href");return c.substr(0,7)==="mailto:"?'[email="'+c.substr(7)+'"]'+b+"[/email]":"[url="+decodeURI(c)+"]"+b+"[/url]"},html:function(a,b,c){if(typeof b.defaultattr=="undefined"||b.defaultattr.length===0)b.defaultattr=c;return'<a href="'+encodeURI(b.defaultattr)+'">'+c+"</a>"}},email:{quoteType:a.sceditor.BBCodeParser.QuoteType.never,html:function(a,b,c){return typeof b.defaultattr=="undefined"&&(b.defaultattr=c),'<a href="mailto:'+b.defaultattr+'">'+c+"</a>"}},quote:{tags:{blockquote:null},isInline:!1,quoteType:a.sceditor.BBCodeParser.QuoteType.never,format:function(b,c){var d="",e=a(b),f=e.children("cite").first();if(f.length===1||e.data("author"))d=f.text()||e.data("author"),e.data("author",d),f.remove(),e.children("cite").replaceWith(function(){return a(this).text()}),c=this.elementToBbcode(a(b)),d="="+d;return"[quote"+d+"]"+c+"[/quote]"},html:function(a,b,c){return typeof b.defaultattr!="undefined"&&(c="<cite>"+b.defaultattr+"</cite>"+c),"<blockquote>"+c+"</blockquote>"}},code:{tags:{code:null},isInline:!1,allowedChildren:["#","#newline"],format:"[code]{0}[/code]",html:"<code>{0}</code>"},left:{styles:{"text-align":["left","-webkit-left","-moz-left","-khtml-left"]},isInline:!1,format:"[left]{0}[/left]",html:'<div align="left">{0}</div>'},center:{styles:{"text-align":["center","-webkit-center","-moz-center","-khtml-center"]},isInline:!1,format:"[center]{0}[/center]",html:'<div align="center">{0}</div>'},right:{styles:{"text-align":["right","-webkit-right","-moz-right","-khtml-right"]},isInline:!1,format:"[right]{0}[/right]",html:'<div align="right">{0}</div>'},justify:{styles:{"text-align":["justify","-webkit-justify","-moz-justify","-khtml-justify"]},isInline:!1,format:"[justify]{0}[/justify]",html:'<div align="justify">{0}</div>'},youtube:{allowsEmpty:!0,tags:{iframe:{"data-youtube-id":null}},format:function(a,b){return(a=a.attr("data-youtube-id"))?"[youtube]"+a+"[/youtube]":b},html:'<iframe width="560" height="315" src="http://www.youtube.com/embed/{0}?wmode=opaque" data-youtube-id="{0}" frameborder="0" allowfullscreen></iframe>'},rtl:{styles:{direction:["rtl"]},format:"[rtl]{0}[/rtl]",html:'<div style="direction: rtl">{0}</div>'},ltr:{styles:{direction:["ltr"]},format:"[ltr]{0}[/ltr]",html:'<div style="direction: ltr">{0}</div>'},ignore:{}},a.sceditorBBCodePlugin.bbcode={get:function(b){return a.sceditorBBCodePlugin.bbcodes[b]||null},set:function(b,c){return!b||!c?!1:(c=a.extend(a.sceditorBBCodePlugin.bbcodes[b]||{},c),c.remove=function(){a.sceditorBBCodePlugin.bbcode.remove(b)},a.sceditorBBCodePlugin.bbcodes[b]=c,this)},rename:function(a,b){return this.hasOwnProperty(a)?(this[b]=this[a],this.remove(a),this):!1},remove:function(b){return a.sceditorBBCodePlugin.bbcodes[b]&&delete a.sceditorBBCodePlugin.bbcodes[b],this}},a.fn.sceditorBBCodePlugin=function(b){return b=b||{},a.isPlainObject(b)&&(b.plugins=(b.plugins?b.plugins:"")+"bbcode"),this.sceditor(b)}}(jQuery,window,document);